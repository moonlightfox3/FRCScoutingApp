<!doctype html>
<title>Content Manager</title>
<link rel="icon" href="../icons/icon.svg">
<link rel="apple-touch-icon" sizes="1024x1024" href="../icons/apple-touch-icon-1024x1024.png">
<link rel="manifest" href="../manifest.json">
<link rel="stylesheet" href="../libs/style.css">
<link rel="stylesheet" href="./contentManager-style.css">

<a href="../index.html"><button id="backBtn">Back</button></a> | Content Manager
<hr>
This tool is intended for testing and app development.<br>
<br>
<button id="clearStorageBtn">Clear LocalStorage</button> <i>Remove all of this app's browser data</i><br>
<button id="clearCacheBtn">Clear cache(s)</button> <i>Reinstall this app's latest version</i><br>
<button id="removeSwBtn">Remove service worker</button> <i>Reinstall this app's updater</i>

<script src="../libs/swrun.js"></script>
<script src="../libs/install.js"></script>
<script>
    clearStorageBtn.onclick = function () {
        if (!confirm("Are you sure you want to clear LocalStorage?\nThis will remove your locally saved files and reset your settings.")) return

        localStorage.removeItem("FRCScoutingApp_lightMode")
        localStorage.removeItem("FRCScoutingApp_files")
        localStorage.removeItem("FRCScoutingApp_temp_importFile")

        alert("LocalStorage cleared.")
        if (confirm("Reload?")) location.reload()
    }
    clearCacheBtn.onclick = async function () {
        if (!confirm("Are you sure you want to clear the cache(s)?\nThis will prevent you from using this page offline until you reload it again while online.")) return

        let names = await caches.keys()
        let relevantNames = names.filter(val => val.startsWith("FRCScoutingApp_"))
        for (let name of relevantNames) await caches.delete(name)

        alert("Cache(s) cleared.")
        if (confirm("Reload?")) location.reload()
    }
    removeSwBtn.onclick = async function () {
        if (!confirm("Are you sure you want to remove the service worker?\nThis will prevent you from using this page offline until you reload it again while online.")) return

        await unregisterSw()
        
        alert("Service worker removed.")
        if (confirm("Reload?")) location.reload()
    }
</script>
